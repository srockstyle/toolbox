# Webサーバ

 WEBサーバについて書きます。

## ミドルウェア

現在残っている情報は以下。

 * nginx
 * Apache

最近はnginxのほうが多い。

### nginx

軽量・高速なWebサーバ。

 * nginx http://nginx.org/en/

個人的には一番好き。高速といわれるh20と比較してもチューニングすればほぼほぼ変わらない速度。

アプリケーションのコードを実行するサーバと組み合わせて使う場合が多い。

 * Ruby:Passenger / Unicorn / puma
 * PHP: php-fpm / hhvm
 * Python : uwsgi

アクセスをプロセス&スレッド形式ではなくイベント駆動で処理するため静的ファイルを処理するのが非常に高速。

### Apache

みんな大好き歴史あるApache。まだ動いているところは動いてる。

Apache2.4は大幅に改善されて、イベント駆動での動作が導入された。

プロキシ方式もできるけど、モジュールとしてPHPを組み込むことで高速な動作が可能。

## セキュリティ

セキュリテイについて。

### 定義

セキュリテイとは？

#### Confidentiality（機密性）

権限のない第三者は情報を開示しないこと。

#### Integrity（保全生）

情報を送信＆保管時に変更しないこと。変更していいのは権限のある人間のみ。

#### Availability（可用性）

正当な権限をもつ関係者がリソースや情報にアクセスでき、アクセスを妨げられないこと。

#### Accountability（責任の追求）

ユーザの身元を管理し、行動を記録することでユーザを追跡可能な状態にすること。

### 心構え

100パーセントの安全を確保するのは無理であることを心にとめておくこと。

### 原則

セキュリテイの原則は以下。

#### 区分する

一部が被害をうけても被害が限定的になる状態に保つ。

#### 最低限の権限だけ与える

システムの各部分に与える権限は以下を満たすこと。

 * 通常の作業に必要な権限のみあたえる
 * 必要以上の権限は与えないこと


#### 多層防御を実装する

SELinux -> Iptablesといった複数の防御を実施する。（SELINUX使わないけど）

#### 進んで情報を提供しない

情報を開示してしまうと結局助けることになるので進んで提供しないこと。

#### 安全に失敗する

機能の一部が失敗するようなら、その機能自体を停止する。

#### もっとも弱いところを強くする

システム全体のセキュリテイレベルが、弱いところと同じレベルにあるように調節する。

#### 作業は単純に

「人間にできる概念は七つまで」

単純な仕組みを入れること。
